!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.cytoscapeTimebar=e():t.cytoscapeTimebar=e()}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function a(t,e,n){return(a=i()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return n&&r(a,n.prototype),a}).apply(null,arguments)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var s=n(2);t.exports=function(){var t=this;return a(s.Timebar,[t].concat(Array.prototype.slice.call(arguments)))}},function(t,e,n){"use strict";n.r(e);var i=n(0),a=n.n(i),r=function(t){t&&t("core","timebar",a.a)};"undefined"!=typeof cytoscape&&r(cytoscape),e.default=r},function(t,e,n){"use strict";n.r(e);var i=["January","February","March","April","May","June","July","August","September","October","November","December"],a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],r={century:31536e8,decade:31536e7,year:31536e6,quarter:7884e6,month:2592e6,week:6048e5,day:864e5,hour:36e5,"5min":3e5,minute:6e4,"5sec":5e3,second:1e3,"50ms":50,ms:1};function s(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return Math.abs(t-e)<n}var o=-59011466152e3;function h(t,e,n){var i;return function(){var a=this,r=arguments,s=function(){i=null,n||t.apply(a,r)},o=n&&!i;clearTimeout(i),i=setTimeout(s,e),o&&t.apply(a,r)}}function l(t,e){if(null==t)return e;for(var n in e)void 0===t[n]&&(t[n]=e[n]);return t}var u={isEnabled:!0,playingStep:50,playingPeriod:1350,zoomingStep:50,graphInclusionType:0,statsInclusionType:0,isHideDisconnectedNodesOnAnim:!1,globalRangeMin:-59011466152e3,globalRangeMax:325036692e5,isMaintainGraphRange:!1,graphRangeRatio:.33,defaultBeginDate:-6311592e5,defaultEndDate:25245972e5},c=[{name:"# nodes",incrementFn:function(t){return t.isNode()?1:0},color:"#FF0000"},{name:"# edges",incrementFn:function(t){return t.isEdge()?1:0},color:"#0000FF"}],g={maintainFiltering:function(t){return t},showOnlyElems:function(t,e){var n=window.cy.$().not(t);t.style("visibility","visible"),n.style("visibility","hidden")},chartRendered:function(){},statsRangeChanged:function(){},graphRangeChanged:function(){}};function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(a)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var p=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.textStyle={fontSize:11,fontName:"Arial"},this.isReady=!1,this.rangeChange=h(e,500,!1).bind(this),this.htmlElem=n,this.colors=i}var e,n,i;return e=t,(n=[{key:"load",value:function(t){var e=this;setTimeout((function(){var n=document.createElement("script");n.onload=function(){google.charts.load("46",{packages:["corechart","controls"]}),google.charts.setOnLoadCallback((function(){e.initChart(t)}))},n.src="https://www.gstatic.com/charts/loader.js",document.head.appendChild(n)}),200)}},{key:"initChart",value:function(t){var e=new google.visualization.Dashboard,n=new google.visualization.ControlWrapper({controlType:"ChartRangeFilter",containerId:this.htmlElem.controllerElemId,options:{filterColumnIndex:0,ui:{chartType:"LineChart",chartOptions:{colors:this.colors,enableInteractivity:!1,chartArea:{left:5,right:5,bottom:0},legend:"none",hAxis:{textStyle:this.textStyle},vAxis:{textPosition:"none",gridlines:{color:"none"}}},snapToData:!1}}}),i=new google.visualization.ChartWrapper({chartType:"ColumnChart",containerId:this.htmlElem.chartElemId,options:{legend:{textStyle:this.textStyle},tooltip:{isHtml:!0},hAxis:{textStyle:this.textStyle,textPosition:"in"},vAxis:{textStyle:this.textStyle},chartArea:{left:20,top:7,bottom:25},colors:this.colors}});e.bind(n,i),this.dashboard=e,this.chartWrapper=i,this.controlWrapper=n,window.controlWrapper=n,window.chartWrapper=i,this.isReady=!0,this.setControllerRange(o,325036692e5,!1),this.removeListener(),this.addListener(),t()}},{key:"setControllerRange",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.isReady){if(!t||!e){var i=this.getControllerRange(),a=d(i,2),r=a[0],s=a[1];t||(t=r),e||(e=s)}if(!(t>=e))return this.controlWrapper.setState({range:{start:new Date(t),end:new Date(e)}}),n&&this.controlWrapper.draw(),0;console.log("can not set start > end ")}}},{key:"getControllerRange",value:function(){if(!this.isReady)return[o,325036692e5];var t=this.controlWrapper.getState(),e=o,n=325036692e5;return t&&t.range&&(t.range.start&&t.range.start.getTime&&(e=t.range.start.getTime()),t.range.end&&t.range.end.getTime&&(n=t.range.end.getTime())),[e,n]}},{key:"setTicksForBarChart",value:function(t){this.isReady&&(this.chartWrapper.setOption("hAxis.ticks",t),this.controlWrapper.draw())}},{key:"setColors",value:function(){if(this.chartWrapper&&this.controlWrapper&&this.isReady){for(var t=0;t<this.colors.length;t++)this.colors[t]||(this.colors[t]="#000000");this.chartWrapper.setOption("colors",this.colors),this.controlWrapper.setOption("ui.chartOptions.colors",this.colors)}}},{key:"drawDashboard",value:function(t){if(this.isReady){var e=google.visualization.arrayToDataTable(t,!1);this.dashboard.draw(e)}}},{key:"drawControl",value:function(){this.isReady&&this.controlWrapper.draw()}},{key:"removeListener",value:function(){window.google&&google.visualization.events.removeListener(this.googleEvent)}},{key:"addListener",value:function(){window.google&&(this.googleEvent=google.visualization.events.addListener(this.controlWrapper,"statechange",this.rangeChange))}}])&&f(e.prototype,n),i&&f(e,i),t}();function y(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(a)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function R(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var b=function(){function t(e,n,i,a,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.graphDates=[],this.cursorPos=0,this.sampleCount=100,this.playTimerId=-1,this.IDEAL_SAMPLE_CNT=60,this.MIN_ZOOM_RANGE=10,this.currTimeUnit=36e5,this.beginPropertyName="begin_datetime",this.endPropertyName="end_datetime",this.GRAPH_RANGE_RATIO_MIN=.2,this.GRAPH_RANGE_RATIO_MAX=.8,this.ignoreEndNodesForEdgeInclusion=!0,this.isChartClientReady=!1,this.cy=e,this.dataMapping=n,this.htmlElem=i,this.settings=l(a,u),this.settings.events=l(a.events,g),this.setGraphRangeRatio(this.settings.graphRangeRatio),a.stats||(this.settings.stats=c),this.api=r,this.chartClient=new p(this.rangeChange.bind(this),i,this.settings.stats.map((function(t){return t.color}))),this.chartClient.load(this.cyElemListChanged.bind(this)),this.unbindCommands(),this.bindCommands(),this.unbindEventListeners(),this.bindEventListeners()}var e,n,d;return e=t,(n=[{key:"cyElemListChanged",value:function(){if(this.settings.isEnabled&&!this.settings.isIgnoreElemChanges){var t=this.cy.$().map((function(t){return t}));this.items=[];for(var e=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=0;i<t.length;i++){var a=v(this.getTimeRange(t[i]),2),r=a[0],s=a[1];n=Math.max(n,r,s),e=Math.min(e,r,s),this.items.push({start:r,end:s,cyElem:t[i]})}this.items.length<1?this.drawEmptyData():(this.prepareChartData(e,n),this.settings.isMaintainGraphRange?(this.renderChart(),this.setStatsRangeByRatio()):this.api.coverVisibleRange())}}},{key:"drawEmptyData",value:function(){this.chartClient.drawDashboard([["instance no","#"],[new Date,0]])}},{key:"getStatsForRange",value:function(t,e){var n,i=this.settings.statsInclusionType,a=this.items,r=this.settings.stats,s=function(t){return t.cyElem.data("collapsedEdges")||t.cyElem.data("collapsedChildren")},o=function(t){return!0};1==i?o=function(n){return n.start>=t&&n.start<=e}:2==i?o=function(n){return(n.start+n.end)/2>=t&&(n.start+n.end)/2<=e}:3==i?o=function(n){return n.end>=t&&n.end<=e}:0==i&&(o=function(n){return n.start<=e&&n.end>=t}),n=a.filter((function(t){return o(t)||s(t)}));for(var h=new Array(r.length).fill(0),l=0;l<r.length;l++)for(var u=0;u<n.length;u++)this.count4Collapsed(n[u],r[l],h,l,o,s);return h}},{key:"count4Collapsed",value:function(t,e,n,i,a,r){var s=this,o=function(t){var e=v(s.getTimeRange(t),2);return{start:e[0],end:e[1],cyElem:t}};if(r(t)){var h=t.cyElem.data("collapsedEdges");if(h)for(var l=0;l<h.length;l++){var u=o(h[l]);r(u)?this.count4Collapsed(u,e,n,i,a,r):a(u)&&(n[i]+=e.incrementFn(h[l]))}else for(var c=function(t){return t.cyElem.data("collapsedChildren")}(t),g=0;g<c.length;g++){var d=o(c[g]);r(d)?this.count4Collapsed(d,e,n,i,a,r):a(d)&&(n[i]+=e.incrementFn(c[g]))}}else n[i]+=e.incrementFn(t.cyElem)}},{key:"getTimeRange",value:function(t){var e=this,n=t.classes().map((function(t){return t.toLowerCase()}));if(!this.dataMapping)return[this.settings.defaultBeginDate,this.settings.defaultEndDate];var i=t.children(),a=t.data("collapsedEdges");a&&(i=i.union(a));var r=t.data("collapsedChildren");if(r&&(i=i.union(r)),i.length>0){for(var s=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,h=0;h<i.length;h++){var l=v(this.getTimeRange(i[h]),2),u=l[0],c=l[1];u<s&&(s=u),c>o&&(o=c)}return[s,o]}var g=function(i){if(-1===n.findIndex((function(t){return t==i.toLowerCase()})))return"continue";var a=e.dataMapping[i][e.beginPropertyName],r=e.dataMapping[i][e.endPropertyName],s=t.data()[a],o=t.data()[r];return s&&o?{v:[s,o]}:s&&!o?{v:[s,e.settings.defaultEndDate]}:!s&&o?{v:[e.settings.defaultBeginDate,o]}:{v:[e.settings.defaultBeginDate,e.settings.defaultEndDate]}};for(var d in this.dataMapping){var f=g(d);switch(f){case"continue":continue;default:if("object"===m(f))return f.v}}return[this.settings.defaultBeginDate,this.settings.defaultEndDate]}},{key:"getTimeFilteredGraphElems",value:function(t,e){var n=this.cy.collection(),i=[];0==this.settings.graphInclusionType?i=this.items.filter((function(n){return n.start<=e&&n.end>=t})).map((function(t){return t.cyElem})):1==this.settings.graphInclusionType?i=this.items.filter((function(n){return t<=n.start&&e>=n.end})).map((function(t){return t.cyElem})):2==this.settings.graphInclusionType&&(i=this.items.filter((function(n){return n.start<=t&&n.end>=e})).map((function(t){return t.cyElem})));for(var a=0;a<i.length;a++)n=n.union(i[a]);return this.ignoreEndNodesForEdgeInclusion&&(n=n.union(n.edges().connectedNodes())),n}},{key:"putStatDataForRange",value:function(t,e,n,i){var a=this.getStatsForRange(t,e);i.push([new Date(n)].concat(y(this.getToolTippedData.call(this,t,a)))),this.graphDates.push(n)}},{key:"getVisibleRange",value:function(){for(var t=this.cy.filter((function(t){return t.visible()})).map((function(t){return t})),e=o,n=325036692e5,i=0;i<t.length;i++){var a=v(this.getTimeRange(t[i]),2),r=a[0],s=a[1];r<n&&(n=r),s>e&&(e=s)}return 325036692e5===n?[o,325036692e5]:[n,e]}},{key:"bindEventListeners",value:function(){this.cyElemChangeHandler=h(this.cyElemListChanged,200,!1).bind(this),this.cy.on("add remove",this.cyElemChangeHandler),this.windowResizer=h(this.renderChart,200,!1).bind(this),window.addEventListener("resize",this.windowResizer)}},{key:"unbindEventListeners",value:function(){this.cyElemChangeHandler&&this.cy.off("add remove",this.cyElemChangeHandler),this.windowResizer&&window.removeEventListener("resize",this.windowResizer)}},{key:"bindCommands",value:function(){var t=this;this.zoomFn=function(e){t.api.changeZoom(e.deltaY<0)},document.getElementById(this.htmlElem.controllerElemId).addEventListener("wheel",this.zoomFn)}},{key:"addChartListener",value:function(){this.chartClient.addListener()}},{key:"removeChartListener",value:function(){this.chartClient.removeListener()}},{key:"unbindCommands",value:function(){document.getElementById(this.htmlElem.controllerElemId).removeEventListener("wheel",this.zoomFn)}},{key:"prepareChartData",value:function(t,e){this.minDate=t,this.maxDate=e,this.resetStatsRange()}},{key:"prepareData3",value:function(){var t=[],e=!0,n=!1,i=void 0;try{for(var a,r=this.settings.stats[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var s=a.value;t.push(s.name),t.push({type:"string",role:"tooltip",p:{html:!0}})}}catch(t){n=!0,i=t}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}var o=[["instance no"].concat(t)],h=this.quantizeDateRange(this.statsRange1,this.statsRange2,this.IDEAL_SAMPLE_CNT),l=this.getQuantizedTime(h,!0).getTime();for(this.graphDates=[],this.putStatDataForRange(this.statsRange1,h,this.statsRange1,o);l<this.statsRange2;)this.putStatDataForRange(h,l,(h+l)/2,o),h=this.getQuantizedTime(h,!0).getTime(),l=this.getQuantizedTime(h,!0).getTime();this.putStatDataForRange(l,this.statsRange2,this.statsRange2,o),this.settings.events.statsRangeChanged(this.graphDates[0],this.graphDates[this.graphDates.length-1]);var u=v(this.chartClient.getControllerRange(),2),c=u[0],g=u[1];this.settings.events.graphRangeChanged(c,g),this.setTicksForBarChart(),this.chartClient.drawDashboard(o)}},{key:"quantizeDateRange",value:function(t,e,n){var i=e-t,a=Number.MAX_SAFE_INTEGER,s="",o=Number.MAX_SAFE_INTEGER,h="";for(var l in r){var u=r[l],c=Math.round(i/u),g=Math.abs(c-n);g<a&&(a=g,s=l),g<o&&c>10&&(o=g,h=l)}return""!=h&&(s=h),this.currTimeUnit=r[s],this.selectedTimeUnit=s,this.getQuantizedTime(t,!0).getTime()}},{key:"setTicksForBarChart",value:function(){var t=v(this.chartClient.getControllerRange(),2),e=t[0],n=t[1];e<this.statsRange1&&(e=this.statsRange1),n>this.statsRange2&&(n=this.statsRange2);for(var i=this.getQuantizedTime(e,!1).getTime(),a=[];i<=n;){var r=new Date(i);a.push({v:r,f:this.getTickStrForDate(r)}),i=this.getQuantizedTime(i,!0).getTime()}var s=new Date(i);a.push({v:s,f:this.getTickStrForDate(s)}),this.chartClient.setTicksForBarChart(a)}},{key:"getQuantizedTime",value:function(t,e){var n=this.selectedTimeUnit,i=new Date(t),a=i.getFullYear(),r=i.getMonth()+1,s=i.getDate(),o=i.getHours(),h=i.getMinutes(),l=i.getSeconds(),u=i.getMilliseconds();if("decade"==n||"century"==n){var c="decade"==n?10:100,g=a-a%c;return e?new Date(g+c,0,1):new Date(g,0,1)}if("year"==n)return e?new Date(a+1,0,1):new Date(a,0,1);if("quarter"==n){var d=3*Math.ceil(r/3)-2;return e?new Date(a,d+2,1):new Date(a,d,1)}if("month"==n)return e?new Date(a,r,1):new Date(a,r-1,1);if("week"==n){var f=(i.getDay()+6)%7;return e?new Date(a,r-1,s-f+7):new Date(a,r-1,s-f)}if("day"==n)return e?new Date(a,r-1,s+1):new Date(a,r-1,s);if("hour"==n)return e?new Date(a,r-1,s,o+1):new Date(a,r-1,s,o);if("5min"==n){var p=5*Math.floor(h/5);return e?new Date(a,r-1,s,o,p+5):new Date(a,r-1,s,o,p)}if("minute"==n)return e?new Date(a,r-1,s,o,h+1):new Date(a,r-1,s,o,h);if("5sec"==n){var y=5*Math.floor(l/5);return e?new Date(a,r-1,s,o,h,y+5):new Date(a,r-1,s,o,h,y)}if("second"==n)return e?new Date(a,r-1,s,o,h,l+1):new Date(a,r-1,s,o,h,l);if("50ms"==n){var m=50*Math.floor(u/50);return e?new Date(a,r-1,s,o,h,l,m+50):new Date(a,r-1,s,o,h,l,m)}if("ms"==n)return e?new Date(a,r-1,s,o,h,l,u+1):new Date(a,r-1,s,o,h,l,u);throw"unknown timeUnit: "+n}},{key:"getTickStrForDate",value:function(t){return"decade"==this.selectedTimeUnit||"century"==this.selectedTimeUnit||"year"==this.selectedTimeUnit?""+t.getFullYear():"quarter"==this.selectedTimeUnit||"month"==this.selectedTimeUnit?""+(t.getMonth()+1):"week"==this.selectedTimeUnit||"day"==this.selectedTimeUnit?""+t.getDate():"hour"==this.selectedTimeUnit?""+t.getHours():"minute"==this.selectedTimeUnit||"5min"==this.selectedTimeUnit?""+t.getMinutes():"second"==this.selectedTimeUnit||"5sec"==this.selectedTimeUnit?""+t.getSeconds():"50ms"==this.selectedTimeUnit||"ms"==this.selectedTimeUnit?""+t.getMilliseconds():"?"}},{key:"getToolTippedData",value:function(t,e){var n=this.selectedTimeUnit,r=new Date(t),s=r.getFullYear(),o=r.getMonth()+1,h=r.getDate(),l=r.getHours(),u=r.getMinutes(),c=r.getSeconds(),g=r.getMilliseconds(),d=[],f="";"century"==n&&(f=s+"-"+(s+100)),"decade"==n&&(f=s+"s"),"year"==n&&(f=s+""),"quarter"==n&&(f="Quarter "+Math.ceil(o/3)+" "+s),"month"==n&&(f=i[o-1]+" "+s),"week"==n&&(f="Week "+a[o-1]+" "+h),"day"==n&&(f="Day "+h),"hour"==n&&(f="Hour "+l),"minute"!=n&&"5min"!=n||(f="Minute "+u),"second"!=n&&"5sec"!=n||(f="Second "+c),"50ms"!=n&&"ms"!=n||(f="Millisecond "+g);var p=0,y=!0,m=!1,v=void 0;try{for(var R,b=e[Symbol.iterator]();!(y=(R=b.next()).done);y=!0){var C=R.value;d.push(C),d.push('<div style="border:2px solid '.concat(this.settings.stats[p++].color,';">').concat(f," <b>").concat(C,"</b></div>"))}}catch(t){m=!0,v=t}finally{try{y||null==b.return||b.return()}finally{if(m)throw v}}return d}},{key:"setStatsRangeByRatio",value:function(){var t=v(this.chartClient.getControllerRange(),2),e=t[0],n=t[1],i=(n+e)/2,a=n-e;a<this.MIN_ZOOM_RANGE&&(e=i-this.MIN_ZOOM_RANGE/2,n=i+this.MIN_ZOOM_RANGE/2,this.chartClient.setControllerRange(e,n),a=this.MIN_ZOOM_RANGE);var r=a/(2*this.settings.graphRangeRatio),s=this.statsRange1,h=this.statsRange2;this.statsRange1=i-r,this.statsRange2=i+r;var l=this.settings.globalRangeMin||o,u=this.settings.globalRangeMax||325036692e5;this.statsRange1<l&&(this.statsRange2+=l-this.statsRange1,this.statsRange1=l,this.setGraphRangeByRatio(s,h,!1)),this.statsRange2>u&&(this.statsRange1-=this.statsRange2-u,this.statsRange2=u,this.setGraphRangeByRatio(s,h,!0)),this.renderChart()}},{key:"setGraphRangeByRatio",value:function(t,e,n){var i=this.statsRange2-this.statsRange1,a=e-t;i>a&&!s(i,a)&&(n?this.statsRange1=t:this.statsRange2=e),this.setGraphRangeByStatsRange(this.statsRange1,this.statsRange2)}},{key:"setGraphRangeByStatsRange",value:function(t,e){var n=(e-t)*(1-this.settings.graphRangeRatio)/2,i=t+n,a=e-n;this.chartClient.setControllerRange(i,a)}},{key:"resetStatsRange",value:function(){this.statsRange1=this.minDate,this.statsRange2=this.maxDate}},{key:"stopPlayTimer",value:function(t){t(!0),clearTimeout(this.playTimerId),this.playTimerId=-1}},{key:"rangeChange",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.items&&!(this.items.length<1)){this.setStatsRangeByRatio();var e=this.chartClient.getControllerRange(),n=v(e,2),i=n[0],a=n[1],r=this.getTimeFilteredGraphElems(i,a);if(r=this.settings.events.maintainFiltering(r),t&&(this.cursorPos=0),this.settings.isHideDisconnectedNodesOnAnim){for(var s=r.components().filter((function(t){return t.length<2})),o=this.cy.collection(),h=0;h<s.length;h++)o=o.union(s[h]);r=r.not(o)}this.settings.events.showOnlyElems(r),this.selectedTimeUnit&&this.setTicksForBarChart()}}},{key:"renderChart",value:function(){var t=this.items,e=this.settings.stats;!t||t.length<1||!e||e.length<1?console.log("there is no data OR stat to render chart"):(this.prepareData3(),this.chartClient.drawControl(),this.settings.events.chartRendered())}},{key:"setIsEnabled",value:function(t){this.settings.isEnabled=t,this.unbindEventListeners(),this.unbindCommands(),this.removeChartListener(),t?(this.bindEventListeners(),this.windowResizer(),this.bindCommands(),this.addChartListener(),this.cyElemChangeHandler()):this.api.coverAllTimes(),this.settings.events.chartRendered()}},{key:"setIsHideDisconnectedNodesOnAnim",value:function(t){this.settings.isHideDisconnectedNodesOnAnim=t,this.rangeChange(!1)}},{key:"setIsIgnoreElemChanges",value:function(t){var e=this;t?this.settings.isIgnoreElemChanges=t:setTimeout((function(){e.settings.isIgnoreElemChanges=t}),200)}},{key:"setIsMaintainGraphRange",value:function(t){this.settings.isMaintainGraphRange=t}},{key:"setPlayingPeriod",value:function(t){this.settings.playingPeriod=t}},{key:"setZoomingStep",value:function(t){this.settings.zoomingStep=1e-6*t*t+.00485*t+.005}},{key:"setPlayingStep",value:function(t){this.settings.playingStep=t}},{key:"setGraphInclusionType",value:function(t){if(t<0||t>2)throw"graphInclusionType is not defined";this.settings.graphInclusionType=t,this.rangeChange(!0)}},{key:"setStatsInclusionType",value:function(t){if(t<0||t>3)throw"statsInclusionType is not defined";this.settings.statsInclusionType=t,this.renderChart()}},{key:"setGlobalRangeMin",value:function(t){this.settings.globalRangeMin=t}},{key:"setGlobalRangeMax",value:function(t){this.settings.globalRangeMax=t}},{key:"setGraphRangeRatio",value:function(t){t<this.GRAPH_RANGE_RATIO_MIN&&(t=this.GRAPH_RANGE_RATIO_MIN),t>this.GRAPH_RANGE_RATIO_MAX&&(t=this.GRAPH_RANGE_RATIO_MAX),this.settings.graphRangeRatio=t}},{key:"setDefaultBeginDate",value:function(t){this.settings.defaultBeginDate=t}},{key:"setDefaultEndDate",value:function(t){this.settings.defaultEndDate=t}}])&&R(e.prototype,n),d&&R(e,d),t}();function C(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],i=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){a=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(a)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.d(e,"Timebar",(function(){return _}));var _=function(){function t(e,n,i,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=new b(e,n,i,a,this),this.setSetting("zoomingStep",a.zoomingStep)}var e,n,i;return e=t,(n=[{key:"changeZoom",value:function(t){if(this._.settings.isEnabled){var e=C(this.getGraphRange(),2),n=e[0],i=e[1],a=i-n;if(!(a<=this._.MIN_ZOOM_RANGE&&t)){var r=Math.floor(this._.settings.zoomingStep*a);t||(r=-r),i-=r,(n+=r)<=o||(this._.chartClient.setControllerRange(n,i),this._.rangeChange(!0))}}}},{key:"getGraphRange",value:function(){return this._.chartClient.getControllerRange()}},{key:"setGraphRange",value:function(t,e){this._.chartClient.setControllerRange(t,e),this._.rangeChange()}},{key:"moveCursor",value:function(t){if(this._.settings.isEnabled){var e=C(this.getGraphRange(),2),n=e[0],i=e[1],a=Math.ceil(i-n),r=Math.ceil(a*this._.settings.playingStep/100),o=this._.maxDate,h=this._.minDate;if(-1===this._.cursorPos&&t||1===this._.cursorPos&&!t)return!1;r>=n-h&&t?(i-=n-h,n=h,this._.cursorPos=-1):r>=o-i&&!t?(n=n+o-i,i=o,this._.cursorPos=1):t?(n-=r,i-=r,this._.cursorPos=0):t||(n+=r,i+=r,this._.cursorPos=0);var l=this._.graphDates[0],u=this._.graphDates[this._.graphDates.length-1];n>=i&&(i=n+this._.currTimeUnit),n<=l&&(this._.statsRange2=this._.statsRange2+n-l,this._.statsRange1=n),i>=u&&(this._.statsRange1=this._.statsRange1+i-u,this._.statsRange2=i),this._.chartClient.setControllerRange(n,i),this._.renderChart();var c=C(this.getGraphRange(),2),g=c[0],d=c[1];return!(!s(g,n)||!s(d,i)||(this._.rangeChange(!1),0))}}},{key:"coverAllTimes",value:function(){this._.settings.isEnabled&&(this._.resetStatsRange(),this._.renderChart(),this._.chartClient.setControllerRange(this._.statsRange1,this._.statsRange2),this._.rangeChange(!0))}},{key:"coverVisibleRange",value:function(){if(this._.settings.isEnabled){var t=C(this._.getVisibleRange(),2),e=t[0],n=t[1];n-e<=1&&(n=e+1e3),this._.resetStatsRange(),this._.renderChart(),this._.chartClient.setControllerRange(e,n),this._.rangeChange(!0)}}},{key:"playTiming",value:function(t){var e=this;this._.settings.isEnabled&&(this._.playTimerId<0?(t(!1),this._.playTimerId=window.setInterval((function(){e.moveCursor(!1)?(t(!1),e._.chartClient.drawControl()):e._.stopPlayTimer(t)}),this._.settings.playingPeriod)):this._.stopPlayTimer(t))}},{key:"setEventListener",value:function(t,e){this._.settings.events[t]=e}},{key:"getCurrTimeUnit",value:function(){return this._.currTimeUnit}},{key:"getGraphRangeRatio",value:function(){return this._.settings.graphRangeRatio}},{key:"setGraphRangeRatio",value:function(t){this._.setGraphRangeRatio(t)}},{key:"setStatsColors",value:function(t){this._.chartClient.colors=t;for(var e=0;e<this._.settings.stats.length;e++)this._.settings.stats[e].color=t[e];this._.chartClient.setColors()}},{key:"setStats",value:function(t){t&&(this._.settings.stats=t,this._.chartClient.colors=t.map((function(t){return t.color})),this._.chartClient.setColors(),this._.renderChart())}},{key:"setSetting",value:function(t,e){var n="set"+t.charAt(0).toUpperCase()+t.slice(1);this._[n](e)}}])&&w(e.prototype,n),i&&w(e,i),t}()}])}));